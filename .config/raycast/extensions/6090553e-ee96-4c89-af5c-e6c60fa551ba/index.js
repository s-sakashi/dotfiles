var F=Object.create;var u=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var v=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var d=e=>u(e,"__esModule",{value:!0});var x=(e,t)=>{for(var n in t)u(e,n,{get:t[n],enumerable:!0})},g=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of P(t))!S.call(e,i)&&(n||i!=="default")&&u(e,i,{get:()=>t[i],enumerable:!(r=N(t,i))||r.enumerable});return e},p=(e,t)=>g(d(u(e!=null?F(v(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),L=(e=>(t,n)=>e&&e.get(t)||(n=g(d({}),t,1),e&&e.set(t,n),n))(typeof WeakMap!="undefined"?new WeakMap:0);var D={};x(D,{default:()=>A});var o=require("@raycast/api"),c=p(require("react")),a=p(require("fs")),f=p(require("path"));function C(e,t){for(let n of t)if(e.includes(n))return!1;return!0}var h=function(e,t,n){let r=a.default.readdirSync(e);return n=n||[],r.forEach(function(i){a.default.statSync(e+"/"+i).isDirectory()&&!i.includes(".obsidian")?n=h(e+"/"+i,t,n):i.endsWith(".md")&&i!==".md"&&!e.includes(".obsidian")&&C(e,t)&&n.push(f.default.join(e,"/",i))}),n};function V(e){let t=T();return h(e.toString(),t,[])}function I(e){let t=e.split(f.default.sep).filter(n=>{if(n!="")return n}).pop();return t||"Default Vault Name (check your path preferences)"}function R(){return(0,o.getPreferenceValues)().vaultPath.split(",").map(n=>({name:I(n.trim()),key:n.trim(),path:n.trim()})).filter(n=>!!n)}function T(){let t=(0,o.getPreferenceValues)().excludedFolders;if(t){let n=t.split(",");for(let r=0;r<n.length;r++)n[r]=n[r].trim();return n}else return[]}function w(e){let t=[],n=0;for(let r of e){let s=r.split("/").pop(),l="default";s&&(l=s.split(".md")[0]);let b={title:l,key:++n,path:r};t.push(b)}return t}function m(e){let t=(0,o.getPreferenceValues)(),n=a.default.readFileSync(e.path,"utf8");if(t.removeYAML){let r=n.match(/---(.|\n)*?---/gm);r&&(n=n.replace(r[0],""))}return t.removeLinks&&(n=n.replaceAll("[[",""),n=n.replaceAll("]]","")),n}function k(e){let t=e.note;return _jsx(c.default.Fragment,null,_jsx(o.PushAction,{title:"Append to note",target:_jsx(O,{note:t}),shortcut:{modifiers:["cmd","shift"],key:"a"},icon:o.Icon.Pencil}),_jsx(o.CopyToClipboardAction,{title:"Copy note content",content:m(t),shortcut:{modifiers:["opt"],key:"c"}}),_jsx(o.PasteAction,{title:"Paste note content",content:m(t),shortcut:{modifiers:["opt"],key:"v"}}),_jsx(o.CopyToClipboardAction,{title:"Copy markdown link",content:`[${t.title}](obsidian://open?path=${encodeURIComponent(t.path)})`,shortcut:{modifiers:["opt"],key:"l"}}),_jsx(o.CopyToClipboardAction,{title:"Copy obsidian URI",content:`obsidian://open?path=${encodeURIComponent(t.path)}`,shortcut:{modifiers:["opt"],key:"u"}}))}function E(e){let t=e.note,n=m(t);return _jsx(o.Detail,{markdown:n,actions:_jsx(o.ActionPanel,null,_jsx(o.OpenAction,{title:"Open in Obsidian",target:"obsidian://open?path="+encodeURIComponent(t.path)}),_jsx(k,{note:t}))})}function O(e){let t=e.note,{pop:n}=(0,o.useNavigation)();function r(i){a.default.appendFileSync(t.path,`

`+i.content),(0,o.showToast)(o.ToastStyle.Success,"Added text to note"),n()}return _jsx(o.Form,{navigationTitle:"Add text to: "+t.title,actions:_jsx(o.ActionPanel,null,_jsx(o.SubmitFormAction,{title:"Submit",onSubmit:r}))},_jsx(o.Form.TextArea,{title:`Add text to:
`+t.title,id:"content",placeholder:"Text"}))}function U(e){let t=e.note,r=(0,o.getPreferenceValues)().primaryAction,i=_jsx(o.PushAction,{title:"Quick Look",target:_jsx(E,{note:t}),icon:o.Icon.Eye}),s=_jsx(o.OpenAction,{title:"Open in Obsidian",target:"obsidian://open?path="+encodeURIComponent(t.path)});return r=="quicklook"?_jsx(c.default.Fragment,null,i,s):r=="obsidian"?_jsx(c.default.Fragment,null,s,i):_jsx(c.default.Fragment,null,i,s)}function y(e){let t=e.vaultPath,[n,r]=(0,c.useState)();return(0,c.useEffect)(()=>{async function i(){try{await a.default.promises.access(t+"/.");let s=V(t),l=w(s);r(l)}catch{(0,o.showToast)(o.ToastStyle.Failure,"The path set in preferences does not exist.")}}i()},[]),_jsx(o.List,{isLoading:n===void 0},n?.map(i=>_jsx(o.List.Item,{title:i.title,key:i.key,actions:_jsx(o.ActionPanel,null,_jsx(U,{note:i}),_jsx(k,{note:i}))})))}function Q(e){let t=e.vaults;return _jsx(o.List,null,t?.map(n=>_jsx(o.List.Item,{title:n.name,key:n.key,actions:_jsx(o.ActionPanel,null,_jsx(o.PushAction,{title:"Select Vault",target:_jsx(y,{vaultPath:n.path})}))})))}function A(){let e=R();if(e.length>1)return _jsx(Q,{vaults:e});if(e.length==1)return _jsx(y,{vaultPath:e[0].path});(0,o.showToast)(o.ToastStyle.Failure,"Path Error","Something went wrong with your vault path.")}module.exports=L(D);0&&(module.exports={});
